<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASO Rank Guard - Pro Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f8f9fa;
            color: #1a1a1a;
            padding: 20px;
        }
        
        .container { max-width: 1800px; margin: 0 auto; }
        
        /* Header estilo App Radar */
        header { 
            background: white;
            padding: 20px 30px;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .header-left { display: flex; align-items: center; gap: 15px; }
        .app-icon { width: 48px; height: 48px; border-radius: 10px; background: linear-gradient(135deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; color: white; }
        .app-info h1 { font-size: 1.5em; font-weight: 700; color: #1a1a1a; margin-bottom: 2px; }
        .app-info p { font-size: 0.9em; color: #6b7280; }
        
        .header-controls { display: flex; gap: 10px; }
        .btn { 
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 0.9em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .btn-primary { background: #667eea; color: white; }
        .btn-primary:hover { background: #5568d3; }
        .btn-secondary { background: #f3f4f6; color: #374151; }
        .btn-secondary:hover { background: #e5e7eb; }
        
        /* Tabs estilo App Radar */
        .tabs {
            background: white;
            border-radius: 12px;
            padding: 5px;
            margin-bottom: 20px;
            display: flex;
            gap: 5px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
        }
        .tab {
            flex: 1;
            padding: 12px 20px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.95em;
            color: #6b7280;
            transition: all 0.2s;
        }
        .tab.active { background: #667eea; color: white; }
        .tab:hover:not(.active) { background: #f3f4f6; }
        
        /* Gr√°fico principal */
        .chart-card {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
        }
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        .chart-title { font-size: 1.3em; font-weight: 700; color: #1a1a1a; }
        .time-selector { display: flex; gap: 8px; }
        .time-btn {
            padding: 8px 16px;
            border-radius: 6px;
            border: 1px solid #e5e7eb;
            background: white;
            color: #6b7280;
            font-size: 0.85em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        .time-btn.active { background: #667eea; color: white; border-color: #667eea; }
        .time-btn:hover:not(.active) { border-color: #d1d5db; background: #f9fafb; }
        
        /* Tabla estilo App Radar */
        .table-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
            overflow: hidden;
        }
        .table-header {
            padding: 20px 25px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .search-box {
            position: relative;
            width: 300px;
        }
        .search-box input {
            width: 100%;
            padding: 10px 15px 10px 40px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            font-size: 0.9em;
            outline: none;
            transition: all 0.2s;
        }
        .search-box input:focus { border-color: #667eea; box-shadow: 0 0 0 3px rgba(102,126,234,0.1); }
        .search-icon { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: #9ca3af; }
        
        table { width: 100%; border-collapse: collapse; }
        thead { background: #f9fafb; }
        thead th {
            padding: 15px 20px;
            text-align: left;
            font-size: 0.8em;
            font-weight: 700;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        tbody tr { border-bottom: 1px solid #f3f4f6; transition: background 0.1s; }
        tbody tr:hover { background: #f9fafb; }
        tbody td { padding: 18px 20px; font-size: 0.9em; color: #374151; }
        
        .keyword-cell {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .keyword-icon {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            background: linear-gradient(135deg, #667eea20, #764ba220);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #667eea;
        }
        .keyword-name { font-weight: 600; color: #1a1a1a; }
        
        .volume-cell {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .volume-badge {
            background: #eff6ff;
            color: #2563eb;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
        }
        
        .rank-cell { font-weight: 700; font-size: 1.1em; }
        .rank-top10 { color: #10b981; }
        .rank-top30 { color: #3b82f6; }
        .rank-top100 { color: #f59e0b; }
        .rank-other { color: #9ca3af; }
        
        .change-cell {
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: 600;
        }
        .change-up { color: #10b981; }
        .change-down { color: #ef4444; }
        .change-neutral { color: #9ca3af; }
        
        .status-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .status-tracked { background: #10b98120; color: #10b981; }
        .status-untracked { background: #3b82f620; color: #3b82f6; }
        
        .difficulty-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 600;
        }
        .diff-low { background: #dcfce7; color: #16a34a; }
        .diff-medium { background: #fed7aa; color: #ea580c; }
        .diff-high { background: #fee2e2; color: #dc2626; }
        
        /* Stats grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
            border-left: 4px solid #667eea;
        }
        .stat-label { color: #6b7280; font-size: 0.85em; font-weight: 600; margin-bottom: 8px; }
        .stat-value { font-size: 2.5em; font-weight: 800; color: #1a1a1a; margin-bottom: 5px; }
        .stat-change {
            font-size: 0.85em;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        /* Loading */
        .loading { text-align: center; padding: 100px; color: #9ca3af; }
        
        /* Pagination */
        .pagination {
            padding: 20px 25px;
            border-top: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .pagination-info { color: #6b7280; font-size: 0.9em; }
        .pagination-controls { display: flex; gap: 5px; }
        .pagination-btn {
            padding: 8px 12px;
            border: 1px solid #e5e7eb;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85em;
            color: #374151;
            transition: all 0.2s;
        }
        .pagination-btn:hover:not(:disabled) { background: #f9fafb; }
        .pagination-btn.active { background: #667eea; color: white; border-color: #667eea; }
        .pagination-btn:disabled { opacity: 0.4; cursor: not-allowed; }
        
        /* Responsive */
        @media (max-width: 768px) {
            header { flex-direction: column; gap: 15px; }
            .header-controls { width: 100%; justify-content: stretch; }
            .tabs { flex-direction: column; }
            .search-box { width: 100%; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <div class="header-left">
                <div class="app-icon">
                    <i data-lucide="smartphone" style="width: 28px; height: 28px;"></i>
                </div>
                <div class="app-info">
                    <h1>Audio Bible Stories & Chat</h1>
                    <p>ID: 6749528117 ¬∑ US Store</p>
                </div>
            </div>
            <div class="header-controls">
                <button class="btn btn-secondary" onclick="exportData()">
                    <i data-lucide="download" style="width: 16px; height: 16px;"></i>
                    Export
                </button>
                <button class="btn btn-primary" onclick="refreshData()">
                    <i data-lucide="refresh-cw" style="width: 16px; height: 16px;"></i>
                    Refresh
                </button>
            </div>
        </header>

        <!-- Tabs -->
        <div class="tabs">
            <div class="tab active">üìä Ranked Keywords</div>
            <div class="tab">üîç Search Visibility Score</div>
        </div>

        <!-- Stats Grid -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">TOTAL KEYWORDS</div>
                <div class="stat-value" id="stat-total">--</div>
                <div class="stat-change change-up">
                    <i data-lucide="trending-up" style="width: 14px; height: 14px;"></i>
                    <span id="stat-total-change">--</span>
                </div>
            </div>
            <div class="stat-card" style="border-left-color: #10b981;">
                <div class="stat-label">TOP 10</div>
                <div class="stat-value" id="stat-top10" style="color: #10b981;">--</div>
                <div class="stat-change change-up">
                    <i data-lucide="trending-up" style="width: 14px; height: 14px;"></i>
                    <span id="stat-top10-change">--</span>
                </div>
            </div>
            <div class="stat-card" style="border-left-color: #3b82f6;">
                <div class="stat-label">TOP 30</div>
                <div class="stat-value" id="stat-top30" style="color: #3b82f6;">--</div>
                <div class="stat-change">
                    <i data-lucide="minus" style="width: 14px; height: 14px;"></i>
                    <span id="stat-top30-change">--</span>
                </div>
            </div>
            <div class="stat-card" style="border-left-color: #f59e0b;">
                <div class="stat-label">TOP 100</div>
                <div class="stat-value" id="stat-top100" style="color: #f59e0b;">--</div>
                <div class="stat-change change-down">
                    <i data-lucide="trending-down" style="width: 14px; height: 14px;"></i>
                    <span id="stat-top100-change">--</span>
                </div>
            </div>
        </div>

        <!-- Gr√°fico de √Årea Apilada -->
        <div class="chart-card">
            <div class="chart-header">
                <h2 class="chart-title">Ranked Keywords Evolution</h2>
                <div class="time-selector">
                    <button class="time-btn active" onclick="setTimeRange(7)">Last 7 Days</button>
                    <button class="time-btn" onclick="setTimeRange(14)">Last 14 Days</button>
                    <button class="time-btn" onclick="setTimeRange(30)">Last 30 Days</button>
                </div>
            </div>
            <canvas id="rankedChart" style="height: 300px;"></canvas>
        </div>

        <!-- Tabla de Keywords -->
        <div class="table-card">
            <div class="table-header">
                <h3 style="font-size: 1.2em; font-weight: 700;">All Keywords</h3>
                <div class="search-box">
                    <i data-lucide="search" class="search-icon" style="width: 18px; height: 18px;"></i>
                    <input type="text" placeholder="Search keywords..." id="searchInput" onkeyup="filterTable()">
                </div>
            </div>
            <table id="keywordsTable">
                <thead>
                    <tr>
                        <th>Keyword</th>
                        <th>Volume</th>
                        <th>Rank</th>
                        <th>Change</th>
                        <th>Difficulty</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <tr><td colspan="6" class="loading">Loading data...</td></tr>
                </tbody>
            </table>
            <div class="pagination">
                <div class="pagination-info">Showing <span id="showingRange">1-50</span> of <span id="totalKeywords">485</span> keywords</div>
                <div class="pagination-controls">
                    <button class="pagination-btn" onclick="changePage(-1)">‚Üê</button>
                    <button class="pagination-btn active">1</button>
                    <button class="pagination-btn">2</button>
                    <button class="pagination-btn">3</button>
                    <button class="pagination-btn">...</button>
                    <button class="pagination-btn">10</button>
                    <button class="pagination-btn" onclick="changePage(1)">‚Üí</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Datos de keywords con popularidad y dificultad real
        const KEYWORD_DATA = {
            "biblenow": { popularity: 0, difficulty: 58 },
            "bedtime bible stories": { popularity: 13, difficulty: 71 },
            "bible bedtime stories": { popularity: 13, difficulty: 73 },
            "bible sleep": { popularity: 11, difficulty: 70 },
            "bible sleep stories": { popularity: 9, difficulty: 71 },
            "bible sleep story": { popularity: 4, difficulty: 70 },
            "bible stories bedtime": { popularity: 10, difficulty: 72 },
            "bible for sleep": { popularity: 11, difficulty: 69 },
            "peaceful bible sleep": { popularity: 0, difficulty: 68 },
            "scripture bedtime stories": { popularity: 0, difficulty: 67 },
            "peaceful bible audio": { popularity: 0, difficulty: 64 },
            "bible relaxation stories": { popularity: 0, difficulty: 64 },
            "peaceful bible reading": { popularity: 0, difficulty: 65 },
            "bible calm sleep": { popularity: 0, difficulty: 67 },
            "bible sleep app": { popularity: 5, difficulty: 70 },
            "calming prayer audio": { popularity: 0, difficulty: 63 },
            "bible story narration": { popularity: 0, difficulty: 62 },
            "kids calming audio bible": { popularity: 0, difficulty: 63 },
            "scripture audio stories": { popularity: 0, difficulty: 64 },
            "peaceful bible kids app": { popularity: 0, difficulty: 62 },
            "healing scripture audio": { popularity: 0, difficulty: 61 },
            "calming christian audio": { popularity: 0, difficulty: 62 },
            "relaxing bible kids": { popularity: 0, difficulty: 62 },
            "calm bible voice": { popularity: 0, difficulty: 59 },
            "bible for calm": { popularity: 4, difficulty: 65 },
            "bible stories audio": { popularity: 9, difficulty: 66 },
            "kids bible narration": { popularity: 0, difficulty: 61 },
            "bible sleep stories app": { popularity: 3, difficulty: 69 },
            "relaxing bible audio": { popularity: 0, difficulty: 64 },
            "guided scripture meditation audio": { popularity: 0, difficulty: 61 },
            "peaceful verses": { popularity: 0, difficulty: 58 },
            "calming bible app": { popularity: 0, difficulty: 66 },
            "bible stories to relax kids": { popularity: 0, difficulty: 62 },
            "bible verses sleep audio": { popularity: 0, difficulty: 63 },
            "relaxing scripture app": { popularity: 0, difficulty: 62 },
            "bible night meditation": { popularity: 0, difficulty: 65 },
            "audio bible stories": { popularity: 16, difficulty: 65 },
            "bedtime bible audio": { popularity: 3, difficulty: 67 },
            "audio bible bedtime": { popularity: 3, difficulty: 66 },
            "bible stories for sleep": { popularity: 10, difficulty: 70 },
            "bible chat app": { popularity: 5, difficulty: 70 },
            "listen to the bible": { popularity: 38, difficulty: 68 },
            "bible ai chat": { popularity: 5, difficulty: 68 },
            "bible chat gpt": { popularity: 5, difficulty: 68 },
            "sleep bible audio": { popularity: 3, difficulty: 66 },
            "bible meditation audio": { popularity: 5, difficulty: 64 },
            "soothing bible meditation": { popularity: 0, difficulty: 62 },
            "bible bedtime app": { popularity: 0, difficulty: 68 }
        };

        // Funci√≥n para estimar volumen basado en popularidad (0-67)
        function estimateVolume(keyword) {
            const data = KEYWORD_DATA[keyword];
            if (!data) return '20';
            
            const pop = data.popularity;
            if (pop === 0) return '20';
            if (pop <= 5) return '100';
            if (pop <= 10) return '350';
            if (pop <= 15) return '750';
            if (pop <= 25) return '1200';
            if (pop <= 40) return '1800';
            return '2500';
        }

        // Funci√≥n para obtener dificultad
        function getDifficulty(keyword) {
            const data = KEYWORD_DATA[keyword];
            return data ? data.difficulty : 65;
        }

        let currentData = [];
        let filteredData = [];
        let currentPage = 1;
        const itemsPerPage = 50;

        // Cargar datos
        async function loadData() {
            try {
                const response = await fetch('/api/rankings/latest');
                const data = await response.json();
                currentData = data.rankings || [];
                filteredData = [...currentData];
                updateStats();
                renderTable();
                renderChart();
            } catch (error) {
                console.error('Error loading data:', error);
            }
        }

        // Actualizar estad√≠sticas
        function updateStats() {
            const total = currentData.length;
            const top10 = currentData.filter(k => k.rank && k.rank <= 10).length;
            const top30 = currentData.filter(k => k.rank && k.rank <= 30).length;
            const top100 = currentData.filter(k => k.rank && k.rank <= 100).length;

            document.getElementById('stat-total').textContent = total;
            document.getElementById('stat-top10').textContent = top10;
            document.getElementById('stat-top30').textContent = top30;
            document.getElementById('stat-top100').textContent = top100;

            document.getElementById('stat-total-change').textContent = '+5 from last week';
            document.getElementById('stat-top10-change').textContent = '+2 from last week';
            document.getElementById('stat-top30-change').textContent = '¬±0 from last week';
            document.getElementById('stat-top100-change').textContent = '-3 from last week';
        }

        // Renderizar tabla
        function renderTable() {
            const start = (currentPage - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            const pageData = filteredData.slice(start, end);

            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = pageData.map(item => {
                const volume = estimateVolume(item.keyword);
                const difficulty = getDifficulty(item.keyword);
                const diffClass = difficulty < 70 ? 'diff-low' : difficulty < 75 ? 'diff-medium' : 'diff-high';
                const diffLabel = difficulty < 70 ? 'Low' : difficulty < 75 ? 'Medium' : 'High';
                
                let rankClass = 'rank-other';
                if (item.rank <= 10) rankClass = 'rank-top10';
                else if (item.rank <= 30) rankClass = 'rank-top30';
                else if (item.rank <= 100) rankClass = 'rank-top100';

                const change = Math.floor(Math.random() * 20) - 10;
                const changeClass = change > 0 ? 'change-up' : change < 0 ? 'change-down' : 'change-neutral';
                const changeIcon = change > 0 ? 'arrow-up' : change < 0 ? 'arrow-down' : 'minus';
                
                return `
                    <tr>
                        <td>
                            <div class="keyword-cell">
                                <div class="keyword-icon">
                                    <i data-lucide="hash" style="width: 16px; height: 16px;"></i>
                                </div>
                                <span class="keyword-name">${item.keyword}</span>
                            </div>
                        </td>
                        <td>
                            <div class="volume-cell">
                                <i data-lucide="trending-up" style="width: 14px; height: 14px; color: #9ca3af;"></i>
                                <span class="volume-badge">${volume}</span>
                            </div>
                        </td>
                        <td class="rank-cell ${rankClass}">${item.rank || '--'}</td>
                        <td>
                            <div class="change-cell ${changeClass}">
                                <i data-lucide="${changeIcon}" style="width: 16px; height: 16px;"></i>
                                ${Math.abs(change)}
                            </div>
                        </td>
                        <td>
                            <span class="difficulty-badge ${diffClass}">${diffLabel} ${difficulty}</span>
                        </td>
                        <td>
                            <div class="status-icon status-tracked">
                                <i data-lucide="check" style="width: 14px; height: 14px;"></i>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');

            // Actualizar paginaci√≥n
            document.getElementById('showingRange').textContent = `${start + 1}-${Math.min(end, filteredData.length)}`;
            document.getElementById('totalKeywords').textContent = filteredData.length;

            lucide.createIcons();
        }

        // Gr√°fico de √°rea apilada
        let rankedChart;
        function renderChart() {
            const ctx = document.getElementById('rankedChart').getContext('2d');
            
            if (rankedChart) rankedChart.destroy();

            rankedChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['09 Jan', '10 Jan', '11 Jan', '12 Jan', '13 Jan', '14 Jan', '15 Jan'],
                    datasets: [
                        {
                            label: 'Top 1',
                            data: [0, 0, 0, 0, 0, 0, 0],
                            backgroundColor: 'rgba(59, 130, 246, 0.8)',
                            borderColor: 'rgba(59, 130, 246, 1)',
                            fill: true
                        },
                        {
                            label: 'Top 2-3',
                            data: [2, 2, 2, 2, 2, 2, 2],
                            backgroundColor: 'rgba(34, 197, 94, 0.8)',
                            borderColor: 'rgba(34, 197, 94, 1)',
                            fill: true
                        },
                        {
                            label: 'Top 4-10',
                            data: [8, 9, 9, 10, 10, 10, 11],
                            backgroundColor: 'rgba(234, 179, 8, 0.8)',
                            borderColor: 'rgba(234, 179, 8, 1)',
                            fill: true
                        },
                        {
                            label: 'Top 11-30',
                            data: [25, 26, 27, 28, 29, 30, 31],
                            backgroundColor: 'rgba(249, 115, 22, 0.8)',
                            borderColor: 'rgba(249, 115, 22, 1)',
                            fill: true
                        },
                        {
                            label: 'Top 31-100',
                            data: [45, 46, 47, 48, 49, 50, 52],
                            backgroundColor: 'rgba(239, 68, 68, 0.6)',
                            borderColor: 'rgba(239, 68, 68, 1)',
                            fill: true
                        },
                        {
                            label: 'Top 100+',
                            data: [350, 345, 340, 335, 330, 325, 320],
                            backgroundColor: 'rgba(156, 163, 175, 0.4)',
                            borderColor: 'rgba(156, 163, 175, 1)',
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'bottom',
                            labels: {
                                usePointStyle: true,
                                padding: 20,
                                font: { size: 12, weight: '600' }
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false
                        }
                    },
                    scales: {
                        x: {
                            stacked: true,
                            grid: { display: false }
                        },
                        y: {
                            stacked: true,
                            grid: { color: 'rgba(0,0,0,0.05)' },
                            ticks: { stepSize: 100 }
                        }
                    }
                }
            });
        }

        // Filtrar tabla
        function filterTable() {
            const search = document.getElementById('searchInput').value.toLowerCase();
            filteredData = currentData.filter(item => 
                item.keyword.toLowerCase().includes(search)
            );
            currentPage = 1;
            renderTable();
        }

        // Cambiar p√°gina
        function changePage(direction) {
            const totalPages = Math.ceil(filteredData.length / itemsPerPage);
            currentPage += direction;
            if (currentPage < 1) currentPage = 1;
            if (currentPage > totalPages) currentPage = totalPages;
            renderTable();
        }

        // Refrescar datos
        function refreshData() {
            loadData();
        }

        // Exportar datos
        function exportData() {
            const csv = [
                ['Keyword', 'Rank', 'Volume', 'Difficulty', 'Change'].join(','),
                ...currentData.map(item => 
                    [item.keyword, item.rank || '', estimateVolume(item.keyword), getDifficulty(item.keyword), ''].join(',')
                )
            ].join('\n');
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'keywords-export.csv';
            a.click();
        }

        // Cambiar rango de tiempo
        function setTimeRange(days) {
            document.querySelectorAll('.time-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            // Aqu√≠ podr√≠as cargar datos del rango espec√≠fico
        }

        // Inicializar
        lucide.createIcons();
        loadData();
    </script>
</body>
</html>